<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Monitoria de Atendimento Wick</title>
<style>
  body {
    margin: 0; padding: 0;
    font-family: Arial, sans-serif;
    background: linear-gradient(90deg, #6a0dad, #ff7b00);
    color: #333;
  }
  header {
    background: rgba(255 255 255 / 0.85);
    color: #6a0dad;
    font-weight: bold;
    font-size: 24px;
    text-align: center;
    padding: 15px;
    position: sticky;
    top: 0;
    z-index: 10;
    box-shadow: 0 0 8px rgba(0,0,0,0.15);
  }
  .container {
    max-width: 900px;
    background: white;
    margin: 30px auto 50px auto;
    border-radius: 10px;
    padding: 25px 30px;
    box-shadow: 0 4px 20px rgb(0 0 0 / 0.1);
  }
  label {
    font-weight: 700;
    color: #6a0dad;
    display: block;
    margin-top: 18px;
  }
  input[type=text], input[type=date], select, textarea {
    width: 100%;
    padding: 9px 12px;
    margin-top: 6px;
    font-size: 15px;
    border-radius: 6px;
    border: 1.5px solid #ccc;
    box-sizing: border-box;
    transition: border-color 0.3s ease;
  }
  input[type=text]:focus, input[type=date]:focus, select:focus, textarea:focus {
    outline: none;
    border-color: #6a0dad;
    box-shadow: 0 0 8px rgba(106,13,173,0.3);
  }
  textarea {
    resize: vertical;
    min-height: 60px;
  }
  button {
    background-color: #ff7b00;
    color: white;
    font-weight: 700;
    font-size: 16px;
    border: none;
    padding: 12px 20px;
    border-radius: 7px;
    margin-top: 25px;
    cursor: pointer;
    transition: background-color 0.25s ease;
  }
  button:hover {
    background-color: #e56b00;
  }
</style>
</head>
<body>

<header>Monitoria de Atendimento Wick</header>

<div class="container">
  <form id="monitoriaForm" onsubmit="return false;">
    <label for="avaliador">Nome do Avaliador:</label>
    <input type="text" id="avaliador" name="avaliador" required>

    <label for="avaliado">Nome do Avaliado:</label>
    <input type="text" id="avaliado" name="avaliado" required>

    <label for="cliente">Cliente do Atendimento:</label>
    <input type="text" id="cliente" name="cliente" required>

    <label for="protocolo">Protocolo do Atendimento:</label>
    <input type="text" id="protocolo" name="protocolo">

    <label for="data">Data:</label>
    <input type="date" id="data" name="data" required>

    <label for="q1">1. Tempo total do atendimento:</label>
    <textarea id="q1" name="q1" placeholder="Descreva o tempo total do atendimento"></textarea>

    <label for="q2">2. Houve pausas excessivas sem justificativa?</label>
    <select id="q2" name="q2">
      <option value="">Selecione</option>
      <option value="0">Sim</option>
      <option value="1">Não</option>
    </select>

    <label for="q3">3. Se despediu de forma formal e cordial?</label>
    <select id="q3" name="q3">
      <option value="">Selecione</option>
      <option value="1">Sim</option>
      <option value="0">Não</option>
    </select>

    <label for="q4">4. Operadora:</label>
    <select id="q4" name="q4">
      <option value="">Selecione</option>
      <option value="Claro">Claro</option>
      <option value="Vivo">Vivo</option>
      <option value="Tim">Tim</option>
    </select>

    <label for="q5">5. Tipo de solicitação (cancelamento, fatura, portabilidade, etc.):</label>
    <textarea id="q5" name="q5" placeholder="Descreva o tipo de solicitação"></textarea>

    <label for="q6">6. Identificação do cliente confirmada?</label>
    <select id="q6" name="q6">
      <option value="">Selecione</option>
      <option value="1">Sim</option>
      <option value="0">Não</option>
    </select>

    <label for="q7">7. Uso do nome do cliente durante a conversa?</label>
    <select id="q7" name="q7">
      <option value="">Selecione</option>
      <option value="1">Sim</option>
      <option value="0">Não</option>
    </select>

    <label for="q8">8. Tom educado e profissional no texto?</label>
    <select id="q8" name="q8">
      <option value="">Selecione</option>
      <option value="1">Sim</option>
      <option value="0">Não</option>
    </select>

    <label for="q9">9. Tempo para responder a primeira mensagem dentro do SLA?</label>
    <select id="q9" name="q9">
      <option value="">Selecione</option>
      <option value="1">Sim</option>
      <option value="0">Não</option>
    </select>

    <label for="q10">10. Linguagem clara, sem termos técnicos desnecessários?</label>
    <select id="q10" name="q10">
      <option value="">Selecione</option>
      <option value="1">Sim</option>
      <option value="0">Não</option>
    </select>

    <label for="q11">11. Mensagens objetivas, sem textos longos que confundam?</label>
    <select id="q11" name="q11">
      <option value="">Selecione</option>
      <option value="1">Sim</option>
      <option value="0">Não</option>
    </select>

    <label for="q12">12. Escrita correta (gramática e ortografia)?</label>
    <select id="q12" name="q12">
      <option value="">Selecione</option>
      <option value="1">Sim</option>
      <option value="0">Não</option>
    </select>

    <label for="q13">13. Uso adequado de emojis e formatação?</label>
    <select id="q13" name="q13">
      <option value="">Selecione</option>
      <option value="1">Sim</option>
      <option value="0">Não</option>
    </select>

    <label for="q14">14. Confirmação correta dos dados do cliente (nome, CPF, linha)?</label>
    <select id="q14" name="q14">
      <option value="">Selecione</option>
      <option value="1">Sim</option>
      <option value="0">Não</option>
    </select>

    <label for="q15">15. Validação de informações sensíveis de forma segura?</label>
    <select id="q15" name="q15">
      <option value="">Selecione</option>
      <option value="1">Sim</option>
      <option value="0">Não</option>
    </select>

    <label for="q16">16. Coleta apenas do necessário para a demanda?</label>
    <select id="q16" name="q16">
      <option value="">Selecione</option>
      <option value="1">Sim</option>
      <option value="0">Não</option>
    </select>

    <label for="q17">17. Registro no sistema/Tabulação?</label>
    <select id="q17" name="q17">
      <option value="">Selecione</option>
      <option value="1">Sim</option>
      <option value="0">Não</option>
    </select>

    <label for="q18">18. Entendimento total do problema antes de responder?</label>
    <select id="q18" name="q18">
      <option value="">Selecione</option>
      <option value="1">Sim</option>
      <option value="0">Não</option>
    </select>

    <label for="q19">19. Explicação clara dos procedimentos?</label>
    <select id="q19" name="q19">
      <option value="">Selecione</option>
      <option value="1">Sim</option>
      <option value="0">Não</option>
    </select>

    <label for="q20">20. Passo a passo para o cliente, quando necessário?</label>
    <select id="q20" name="q20">
      <option value="">Selecione</option>
      <option value="1">Sim</option>
      <option value="0">Não</option>
    </select>

    <label for="q21">21. Cumprimento de políticas internas da operadora?</label>
    <select id="q21" name="q21">
      <option value="">Selecione</option>
      <option value="1">Sim</option>
      <option value="0">Não</option>
    </select>

    <label for="q22">22. Uso correto de scripts obrigatórios?</label>
    <select id="q22" name="q22">
      <option value="">Selecione</option>
      <option value="1">Sim</option>
      <option value="0">Não</option>
    </select>

    <label for="q23">23. Mostrou compreensão pela situação do cliente?</label>
    <select id="q23" name="q23">
      <option value="">Selecione</option>
      <option value="1">Sim</option>
      <option value="0">Não</option>
    </select>

    <label for="q24">24. Evitou respostas automáticas que não condizem com o caso?</label>
    <select id="q24" name="q24">
      <option value="">Selecione</option>
      <option value="1">Sim</option>
      <option value="0">Não</option>
    </select>

    <label for="q25">25. Manteve calma e cordialidade mesmo em casos de cliente irritado?</label>
    <select id="q25" name="q25">
      <option value="">Selecione</option>
      <option value="1">Sim</option>
      <option value="0">Não</option>
    </select>

    <label for="q26">26. Confirmou que o problema foi resolvido?</label>
    <select id="q26" name="q26">
      <option value="">Selecione</option>
      <option value="1">Sim</option>
      <option value="0">Não</option>
    </select>

    <label for="q27">27. Orientou sobre próximos passos ou protocolos?</label>
    <select id="q27" name="q27">
      <option value="">Selecione</option>
      <option value="1">Sim</option>
      <option value="0">Não</option>
    </select>

    <button type="button" onclick="gerarPDF()">Baixar PDF</button>
  </form>
</div>

<!-- Imagem escondida, só para pegar no script -->
<img id="logoWick" src="https://i.postimg.cc/WpY8c1jL/wick-roxo-sem-fundo.png" style="display:none;" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
  const perguntas = [
    "Tempo total do atendimento",
    "Houve pausas excessivas sem justificativa?",
    "Se despediu de forma formal e cordial?",
    "Operadora",
    "Tipo de solicitação (cancelamento, fatura, portabilidade, etc.)",
    "Identificação do cliente confirmada?",
    "Uso do nome do cliente durante a conversa?",
    "Tom educado e profissional no texto?",
    "Tempo para responder a primeira mensagem dentro do SLA?",
    "Linguagem clara, sem termos técnicos desnecessários?",
    "Mensagens objetivas, sem textos longos que confundam?",
    "Escrita correta (gramática e ortografia)?",
    "Uso adequado de emojis e formatação?",
    "Confirmação correta dos dados do cliente (nome, CPF, linha)?",
    "Validação de informações sensíveis de forma segura?",
    "Coleta apenas do necessário para a demanda?",
    "Registro no sistema/Tabulação?",
    "Entendimento total do problema antes de responder?",
    "Explicação clara dos procedimentos?",
    "Passo a passo para o cliente, quando necessário?",
    "Cumprimento de políticas internas da operadora?",
    "Uso correto de scripts obrigatórios?",
    "Mostrou compreensão pela situação do cliente?",
    "Evito respostas automáticas que não condizem com o caso?",
    "Manteve calma e cordialidade mesmo em casos de cliente irritado?",
    "Confirmou que o problema foi resolvido?",
    "Orientou sobre próximos passos ou protocolos?"
  ];

  const pesos = [
    1, 1, 3, 1, 1, 3, 2, 3, 3, 3,
    2, 3, 1, 3, 3, 2, 1, 3, 3, 2,
    2, 2, 3, 2, 3, 3, 2
  ];

  function quebraLinha(doc, texto, x, y, lineHeight, maxWidth = 180) {
    const splitText = doc.splitTextToSize(texto, maxWidth);
    splitText.forEach((line, i) => {
      doc.text(line, x, y + (i * lineHeight));
    });
    return y + (splitText.length * lineHeight);
  }

  function checarQuebraPagina(doc, y, lineHeight, margemInferior = 20) {
    const paginaAltura = doc.internal.pageSize.getHeight();
    if (y + lineHeight > paginaAltura - margemInferior) {
      doc.addPage();
      return 10;
    }
    return y;
  }

  async function gerarPDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    const img = document.getElementById('logoWick');
    if (!img.complete) {
      await new Promise(resolve => {
        img.onload = resolve;
        img.onerror = resolve;
      });
    }

    const imgWidth = 50;
    const imgHeight = 15;
    const pageWidth = doc.internal.pageSize.getWidth();

    const imgX = pageWidth - imgWidth - 10;
    const imgY = 10;

    doc.addImage(img, 'PNG', imgX, imgY, imgWidth, imgHeight);

    let y = imgY + 5;
    const margin = 10;
    const lineHeight = 8;

    doc.setFontSize(16);
    doc.setTextColor("#6a0dad");
    doc.text("Monitoria de Atendimento Wick", margin, y);
    y += lineHeight * 1.5;

    doc.setFontSize(12);
    doc.setTextColor("#000");

    const dataRaw = document.getElementById("data").value || "";
    let dataFormatada = "Não informado";
    if (dataRaw) {
      const partes = dataRaw.split("-");
      if (partes.length === 3) {
        dataFormatada = `${partes[2]}/${partes[1]}/${partes[0]}`;
      }
    }

    const avaliador = document.getElementById("avaliador").value.trim() || "Não informado";
    const avaliado = document.getElementById("avaliado").value.trim() || "Não informado";
    const cliente = document.getElementById("cliente").value.trim() || "Não informado";
    const protocolo = document.getElementById("protocolo").value.trim() || "Não informado";

    y = checarQuebraPagina(doc, y, lineHeight);
    doc.text(`Data: ${dataFormatada}`, margin, y);
    y += lineHeight;

    y = checarQuebraPagina(doc, y, lineHeight);
    doc.text(`Avaliador: ${avaliador}`, margin, y);
    y += lineHeight;

    y = checarQuebraPagina(doc, y, lineHeight);
    doc.text(`Avaliado: ${avaliado}`, margin, y);
    y += lineHeight;

    y = checarQuebraPagina(doc, y, lineHeight);
    doc.text(`Cliente: ${cliente}`, margin, y);
    y += lineHeight;

    y = checarQuebraPagina(doc, y, lineHeight);
    doc.text(`Protocolo: ${protocolo}`, margin, y);
    y += lineHeight * 1.5;

    let somaPontos = 0;
    let totalPeso = 0;

    for (let i = 0; i < perguntas.length; i++) {
      const num = i + 1;
      let resposta = "";

      if (num === 1 || num === 5) {
        const el = document.getElementById(`q${num}`);
        resposta = el ? el.value.trim() : "";
        if (!resposta) resposta = "Não respondido";
      } else {
        const el = document.getElementById(`q${num}`);
        resposta = el ? el.value : "";
        if (!resposta) resposta = "Não respondido";

        if (resposta === "1") {
          resposta = "Sim";
        } else if (resposta === "0") {
          resposta = "Não";
        }
      }

      const textoPergunta = `${num} - ${perguntas[i]}: ${resposta}`;

      y = checarQuebraPagina(doc, y, lineHeight);
      y = quebraLinha(doc, textoPergunta, margin, y, lineHeight);

      if (resposta === "Sim") {
        somaPontos += pesos[i];
      }
      if (num !== 1 && num !== 5) {
        totalPeso += pesos[i];
      }

      y += lineHeight / 2;
    }

    y = checarQuebraPagina(doc, y, lineHeight * 2);
    const percentual = totalPeso > 0 ? (somaPontos / totalPeso) * 100 : 0;
    doc.setFontSize(14);
    doc.setTextColor("#6a0dad");
    doc.text(`Nota final: ${percentual.toFixed(2)}%`, margin, y);

    doc.save("monitoria_atendimento_wick.pdf");
  }
</script>

</body>
</html>
